#pragma once

/**
 * Strand classifier trained on aMGSIM ground truth.
 * Generated by train_strand_classifier.py
 * Architecture: 43 -> 64 (ReLU) -> 1 (sigmoid)
 * 
 * This classifier predicts whether the forward strand (+) contains
 * the correct reading frame. Output > 0.5 means forward is correct.
 */

#include <array>
#include <cmath>
#include <algorithm>
#include <string>

namespace agp {
namespace strand_nn {

constexpr int INPUT_SIZE = 43;
constexpr int HIDDEN_SIZE = 64;

inline const std::array<float, INPUT_SIZE>& get_input_mean() {
    static const std::array<float, INPUT_SIZE> INPUT_MEAN = {{
        0.01569200f,
        0.06994000f,
        0.89516301f,
        0.34999678f,
        0.48564195f,
        0.42754044f,
        0.45564161f,
        -0.03000034f,
        0.44370635f,
        0.48878487f,
        0.02119000f,
        0.03055000f,
        0.01569200f,
        0.01545900f,
        0.06890500f,
        0.89513224f,
        0.35037654f,
        0.48569253f,
        0.42728053f,
        0.45567903f,
        -0.03001350f,
        0.44369752f,
        0.48930770f,
        0.02131500f,
        0.03057000f,
        0.01545900f,
        0.00023300f,
        0.00103500f,
        0.00003077f,
        -0.00037976f,
        -0.00005058f,
        0.00025992f,
        -0.00003742f,
        0.00001316f,
        0.00000884f,
        -0.00052282f,
        -0.00012500f,
        -0.00002000f,
        0.00023300f,
        -0.00000000f,
        0.00000000f,
        -0.00023300f,
        0.00078757f
    }};
    return INPUT_MEAN;
}

inline const std::array<float, INPUT_SIZE>& get_input_std() {
    static const std::array<float, INPUT_SIZE> INPUT_STD = {{
        0.06056865f,
        0.25504587f,
        0.03252781f,
        0.11807134f,
        0.18177238f,
        0.16416744f,
        0.19833119f,
        0.23467966f,
        0.07070036f,
        0.13767189f,
        0.14401730f,
        0.17209502f,
        0.06056865f,
        0.06009009f,
        0.25329252f,
        0.03249973f,
        0.11819364f,
        0.18126487f,
        0.16415040f,
        0.19882479f,
        0.23426129f,
        0.07066478f,
        0.13778511f,
        0.14443224f,
        0.17214957f,
        0.06009009f,
        0.08684553f,
        0.36616107f,
        0.01023721f,
        0.11573862f,
        0.21672044f,
        0.13982498f,
        0.20230808f,
        0.39450155f,
        0.01633263f,
        0.21980887f,
        0.20365408f,
        0.24238399f,
        0.08684553f,
        0.00000001f,
        1.00000000f,
        0.08684553f,
        0.24741204f
    }};
    return INPUT_STD;
}

inline const std::array<std::array<float, HIDDEN_SIZE>, INPUT_SIZE>& get_W1() {
    static const std::array<std::array<float, HIDDEN_SIZE>, INPUT_SIZE> W1 = {{
        {{-0.35156703f, 0.36064735f, -0.19934662f, 0.00936496f, -0.12100531f, -0.12146224f, -0.11866692f, 0.48812002f, 0.09355810f, 0.17329371f, -0.20181179f, 0.18108930f, 0.29342484f, -0.05672787f, -0.16901632f, 0.11087171f, -0.07502361f, 0.12549901f, -0.10392001f, -0.00328454f, 0.13054839f, -0.52954620f, -0.08613899f, 0.06406048f, -0.11402172f, 0.10783371f, -0.57211781f, -0.15143250f, 0.17465949f, -0.14238323f, 0.03250160f, -0.03471360f, -0.29325753f, 0.16203475f, 0.04540650f, 0.18682212f, -0.21948788f, -0.37471586f, 0.04460293f, -0.07731090f, -0.19445132f, 0.00925128f, -0.06043671f, 0.14752865f, -0.49309710f, 0.00478123f, -0.37870038f, -0.14321969f, 0.10706839f, -0.02422236f, -0.06537008f, 0.07615233f, 0.26002079f, 0.10735121f, 0.16952848f, 0.17966858f, -0.06333184f, -0.24128114f, -0.13677159f, 0.10753766f, 0.01366435f, -0.28113109f, 0.19423757f, -0.05821120f}},
        {{-0.40682688f, 0.12653390f, -0.48158616f, 0.08499660f, -0.15322718f, 0.23854443f, 0.23350105f, 0.12100513f, -0.17687686f, 0.23212589f, 0.15278746f, 0.03157827f, 0.21569559f, -0.14469019f, -0.08295011f, 0.02131393f, 0.15456973f, 0.13810843f, -0.15726286f, -0.12519088f, -0.00156303f, -0.44660565f, 0.13324356f, 0.15770517f, 0.05812877f, -0.05781971f, -0.60918945f, -0.03986656f, 0.26723167f, 0.07820008f, 0.11921991f, 0.10259122f, -0.05782297f, -0.10767002f, -0.35991767f, -0.19959849f, -0.36166605f, -0.14701247f, -0.17730665f, -0.01082165f, 0.15206477f, -0.07477568f, 0.07658328f, 0.07639068f, -0.50635272f, -0.29093587f, -0.39900431f, -0.33809999f, 0.29028502f, 0.28345731f, -0.23586076f, 0.16974731f, 0.16841896f, -0.24797782f, 0.32028735f, 0.01013650f, 0.28192803f, 0.07607005f, -0.00587076f, -0.03206231f, -0.02110967f, -0.20431121f, 0.16587129f, 0.15549123f}},
        {{-0.18259600f, 0.00603165f, 0.04375222f, 0.16771346f, -0.10874502f, -0.04636091f, 0.31422642f, -0.07078858f, -0.05370848f, -0.02477327f, 0.05046311f, 0.01252021f, 0.14952825f, -0.20002784f, 0.03361467f, -0.00753902f, 0.07841910f, -0.02028073f, 0.04693048f, -0.04782259f, -0.19873242f, -0.02257762f, 0.39412469f, -0.15053654f, -0.04897544f, 0.02051759f, 0.15974529f, -0.17202388f, 0.14193979f, 0.00931422f, -0.20387684f, 0.05297376f, -0.35412985f, 0.10972138f, 0.21841034f, 0.14384519f, -0.01053881f, 0.18013287f, -0.02182500f, -0.16713531f, -0.27796289f, -0.06894723f, 0.08140083f, -0.18791525f, -0.05883704f, -0.02218462f, 0.07381248f, -0.28737739f, 0.22255097f, -0.06793837f, 0.18229946f, -0.10680147f, 0.05050880f, -0.12077745f, 0.18648042f, 0.21245457f, -0.17277484f, 0.17261952f, 0.03707619f, 0.01881903f, 0.02203577f, -0.11046777f, -0.26165557f, 0.08627683f}},
        {{0.12650420f, 0.08992299f, -0.04098596f, -0.05904273f, 0.01652028f, 0.06732755f, 0.09886323f, 0.01204090f, 0.40197912f, -0.19376959f, 0.07016783f, 0.20116636f, 0.13700326f, -0.17564200f, -0.59527618f, 0.29461861f, -0.30171785f, -0.15071444f, -0.22544608f, 0.06353117f, 0.31341672f, -0.14706068f, 0.14988840f, -0.28490904f, -0.12942098f, -0.09619069f, -0.00176678f, 0.12208249f, -0.36126336f, -0.08564361f, -0.25771296f, -0.28339425f, -0.19372085f, -0.33714056f, 0.11618512f, -0.08232937f, 0.29529294f, 0.04131113f, 0.17583451f, 0.00722493f, 0.04047081f, -0.01157545f, -0.02316510f, 0.03961432f, 0.07096548f, -0.14078531f, 0.01274845f, -0.23882672f, 0.10458197f, 0.36372423f, 0.17620662f, -0.04154345f, -0.53021747f, -0.14447701f, 0.22193584f, -0.07891285f, 0.08095848f, 0.23305002f, -0.16473794f, -0.12264174f, 0.26789317f, -0.16380437f, -0.22750635f, -0.10707307f}},
        {{0.36995959f, 0.11417219f, 0.06450815f, -0.39588061f, 0.26985589f, -0.11032554f, -0.09252484f, 0.49002182f, -0.10865288f, 0.26603454f, 0.16210206f, 0.18188600f, 0.17624608f, -0.20155802f, 0.22415654f, 0.27887163f, 0.04161190f, 0.20734805f, 0.15440157f, -0.04946344f, 0.53637654f, 0.04878403f, 0.05745583f, 0.00383301f, 0.45743838f, -0.10964379f, -0.25510475f, -0.10816394f, -0.15286064f, -0.65918684f, -0.01663695f, -0.16650906f, -0.38366061f, -0.33462885f, -0.40548885f, -0.41767395f, 0.24323149f, -0.04655095f, -0.18798693f, -0.10302807f, -0.00706771f, -0.30227548f, -0.17674047f, -0.55883628f, -0.24373677f, 0.14847659f, -0.11883850f, -0.33123216f, 0.24091676f, 0.18749160f, 0.15463346f, 0.03576166f, 0.20060724f, -0.26070192f, -0.03252220f, -0.30289584f, 0.14075190f, 0.38103935f, 0.29322740f, -0.03777710f, 0.22990325f, 0.05448849f, -0.19023064f, -0.35462129f}},
        {{-0.28056377f, -0.04611476f, 0.05429393f, -0.27623448f, 0.06212462f, 0.21316542f, -0.13567978f, -0.27071470f, 0.32361972f, -0.34862038f, -0.11783250f, 0.02661134f, -0.49301553f, -0.35095456f, -0.26893780f, -0.00960439f, -0.03383035f, 0.14828262f, 0.00408332f, -0.18158647f, -0.26787764f, -0.08570211f, -0.08021113f, 0.03324877f, 0.06410789f, 0.20064057f, 0.36938950f, 0.05693606f, 0.07922481f, 0.01956861f, -0.09769276f, 0.66820735f, -0.10150457f, -0.17828964f, 0.04600718f, -0.37150288f, -0.53219581f, 0.01586799f, -0.07760237f, -0.28759006f, -0.23152474f, 0.38546905f, -0.31846550f, 0.37025064f, 0.06994196f, -0.15998870f, 0.37452680f, 0.36979994f, 0.02311595f, -0.40474591f, -0.43085387f, -0.53997535f, -0.37232986f, 0.07830991f, -0.36349538f, -0.40385464f, 0.33019182f, -0.20790496f, 0.18524636f, -0.16889384f, -0.54969066f, -0.22407088f, 0.52334541f, 0.25824800f}},
        {{0.55175507f, 0.06964515f, -0.10974439f, -0.06921884f, 0.44430402f, -0.04279210f, 0.00664392f, 0.10395470f, -0.32954955f, 0.31633741f, -0.32059187f, 0.31493139f, 0.27987549f, -0.00943453f, -0.03781123f, 0.11722273f, -0.38565442f, 0.24084045f, -0.03930009f, 0.11795308f, 0.21980710f, 0.11694475f, -0.16407833f, -0.26500168f, -0.01021847f, -0.26458770f, -0.18024482f, 0.31562430f, -0.01681217f, 0.00515685f, 0.22330835f, -0.03557410f, -0.28311747f, -0.46921846f, 0.01346843f, 0.03824932f, 0.21358763f, 0.25529155f, -0.20059618f, -0.14441264f, -0.54231727f, -0.06346614f, -0.11700232f, 0.03070613f, -0.09379165f, 0.10601269f, -0.16435499f, -0.20472941f, 0.17440386f, -0.22351243f, -0.18081240f, 0.25976694f, -0.16512501f, -0.08776003f, -0.09631520f, -0.39305994f, -0.26788574f, 0.23291822f, 0.09120750f, 0.00065379f, 0.15278140f, 0.30212486f, 0.10008642f, 0.06446246f}},
        {{0.19963048f, -0.28002068f, 0.10048079f, 0.23704781f, 0.06915906f, 0.28706121f, -0.40815032f, -0.34505031f, -0.24575666f, 0.03556762f, -0.47140074f, -0.15125449f, -0.30252653f, 0.15738550f, -0.07976411f, -0.06994734f, 0.14022787f, -0.01958645f, -0.26867920f, 0.18572101f, -0.21213712f, 0.18586405f, -0.28550589f, 0.28115985f, -0.62674934f, 0.16225755f, 0.09919721f, 0.25839633f, -0.24096744f, 0.29791480f, 0.37387934f, 0.12234420f, 0.13180475f, 0.07962178f, 0.07742471f, 0.13471180f, 0.02957000f, 0.27870956f, -0.22244185f, -0.12088548f, 0.01879178f, 0.21713313f, 0.06352949f, 0.17847319f, -0.10045567f, -0.02313719f, 0.10111635f, -0.05021323f, 0.04625152f, -0.19347055f, 0.13719204f, 0.28281412f, 0.07849035f, -0.07894576f, -0.22069842f, 0.07926969f, -0.26059198f, -0.29034397f, 0.23599818f, 0.28129756f, 0.02329483f, 0.02659301f, -0.02481456f, 0.09998737f}},
        {{0.20526430f, 0.29700857f, -0.19109444f, 0.01680385f, 0.05808664f, 0.08222626f, 0.28669360f, 0.05196143f, 0.11817268f, 0.22202511f, 0.18497667f, 0.07046030f, 0.24080876f, -0.13340558f, -0.01520823f, -0.02948310f, -0.03592010f, 0.22887883f, 0.21193577f, 0.29577297f, 0.31398785f, 0.20085111f, 0.14347140f, 0.41145411f, 0.26639205f, -0.11556786f, -0.23615529f, -0.16967800f, 0.16560422f, 0.19772218f, 0.07599206f, 0.05793218f, 0.07626904f, -0.27365047f, -0.15167460f, 0.09724323f, -0.01803510f, 0.22927651f, 0.10551164f, 0.25293440f, 0.08109294f, 0.06481147f, 0.25903893f, 0.06711968f, -0.37910366f, -0.02792160f, 0.15846075f, 0.12567824f, 0.37395015f, 0.01420618f, 0.14542024f, -0.34786206f, 0.00114339f, 0.29482439f, 0.18481004f, 0.24101445f, 0.09831065f, -0.15386969f, 0.00842591f, 0.25754455f, 0.05375899f, 0.13870245f, 0.24607585f, 0.30944601f}},
        {{0.04088153f, 0.14332014f, 0.03222010f, 0.22837061f, -0.18465400f, 0.28665701f, -0.08451624f, 0.01590780f, 0.16848384f, -0.18101200f, -0.54133660f, -0.76957411f, -0.27016366f, -0.27799305f, -0.10874442f, -0.15008880f, -0.03088220f, -0.60452551f, 0.35750794f, 0.47140896f, 0.23587441f, -0.05025844f, 0.13870063f, 0.07691534f, -0.35054860f, -0.43901956f, 0.02700278f, -0.38118133f, -0.06741086f, -0.22228998f, -0.33734378f, -0.08546183f, -0.06443972f, -0.16306101f, -0.16320105f, 0.62439728f, -0.07298466f, 0.04131987f, 0.33311024f, 0.44724301f, -0.05602971f, -0.10411749f, 0.22930321f, -0.12999935f, -0.45798495f, -0.22877087f, 0.03726399f, -0.09794979f, 0.43026078f, -0.32376593f, 0.22191010f, 0.23173966f, -0.21229672f, 0.05388494f, -0.21321097f, 0.16723734f, -0.02142059f, -0.19086197f, -0.02028232f, 0.27218255f, 0.29450104f, -0.20844923f, -0.23064525f, -0.23128742f}},
        {{-0.32023737f, 0.03236063f, -0.23324564f, -0.11743116f, -0.22262713f, 0.05458001f, -0.03522307f, -0.07413584f, 0.01404259f, 0.07106333f, -0.15114249f, 0.08051651f, 0.10038617f, 0.00615477f, 0.03894998f, -0.06173523f, -0.18913375f, 0.04210145f, 0.12519199f, 0.04828688f, -0.09950842f, 0.02459192f, 0.01323585f, 0.02498456f, -0.11009945f, -0.05143475f, -0.20090674f, -0.03538029f, -0.03626826f, -0.00944078f, -0.42349154f, 0.15296496f, -0.11726233f, -0.01051861f, -0.14517948f, 0.19968744f, -0.21039653f, 0.07484635f, 0.16089697f, 0.33852029f, -0.09723385f, -0.20142433f, -0.10074910f, 0.08448465f, 0.20089160f, 0.03055857f, 0.02637821f, -0.13526431f, -0.01241423f, -0.19951555f, -0.01716563f, -0.16580680f, -0.10343724f, -0.24801232f, -0.27482456f, 0.06515396f, 0.08131699f, -0.12631372f, -0.11066977f, -0.07665912f, -0.07704519f, -0.44131753f, 0.07660834f, -0.11951118f}},
        {{-0.07684871f, 0.29398793f, 0.02423787f, 0.07705361f, -0.05946715f, 0.13415471f, 0.11479066f, 0.07764790f, -0.03438544f, -0.00818102f, 0.01447869f, -0.06049795f, 0.08537019f, 0.20039028f, -0.02961329f, 0.11257679f, 0.04017914f, -0.34822926f, -0.35746020f, 0.25635958f, -0.07592364f, 0.09689537f, -0.04565584f, 0.13416167f, -0.08644986f, 0.07886376f, -0.17263210f, 0.12831084f, 0.01314003f, -0.45073390f, -0.03827264f, 0.17011984f, -0.02239005f, 0.02340886f, -0.04635075f, 0.03216232f, -0.12480918f, -0.02428903f, 0.10981378f, -0.59799165f, -0.17862579f, 0.08942243f, -0.05721108f, -0.43021029f, 0.15215038f, -0.05662001f, -0.16538167f, 0.10052057f, 0.09154350f, 0.16681729f, -0.42517936f, 0.23445390f, 0.20008492f, -0.07353134f, 0.16757409f, 0.09628087f, -0.01543261f, -0.12897962f, -0.01189560f, 0.30316633f, 0.00628233f, -0.12249539f, 0.00204160f, 0.12109877f}},
        {{-0.36674261f, 0.29944223f, -0.49211127f, 0.12631637f, -0.13443214f, -0.00774422f, 0.23010543f, 0.14949298f, -0.08176976f, 0.17999245f, 0.12840262f, 0.02597334f, 0.22808167f, 0.09895280f, -0.13637047f, 0.18707936f, -0.13273714f, 0.30578026f, -0.03301373f, 0.04847423f, 0.05978509f, -0.14980792f, -0.15156598f, 0.16746666f, -0.09058075f, 0.02613636f, -0.65767854f, 0.01727856f, 0.33477786f, 0.10029714f, 0.07445695f, 0.32034710f, 0.00832521f, -0.21330179f, -0.13813402f, 0.09173143f, -0.16326202f, -0.07503311f, 0.16267166f, 0.15146615f, -0.03946308f, -0.17015272f, 0.38843775f, 0.11426252f, -0.55624592f, 0.12351892f, -0.11565051f, -0.14379671f, 0.12804516f, 0.07676718f, -0.49297398f, -0.13077053f, 0.19566444f, -0.31184283f, 0.04495836f, -0.06761194f, 0.14801016f, 0.09717871f, 0.00485907f, 0.11765836f, 0.17798723f, -0.19628178f, -0.09083603f, -0.01308705f}},
        {{-0.11970516f, -0.05064441f, -0.30139884f, -0.01629979f, 0.25984433f, -0.06348860f, 0.13489364f, 0.20661685f, -0.03869498f, 0.15053719f, -0.12600584f, 0.11266924f, -0.09777641f, -0.00084888f, -0.23510951f, 0.32631114f, -0.13238202f, 0.12710769f, -0.33109558f, 0.15283048f, 0.04952437f, 0.00158642f, -0.08854899f, -0.04216386f, -0.22486745f, -0.01354200f, -0.07945514f, -0.28303179f, 0.32923010f, 0.20098808f, -0.00427987f, 0.04768955f, -0.04427803f, -0.09083239f, -0.54548061f, -0.16558777f, 0.12780540f, 0.15592605f, -0.07244468f, -0.08645733f, 0.05733326f, 0.00403880f, -0.04788143f, -0.31402194f, 0.03066487f, 0.13184932f, -0.29629889f, -0.04724120f, -0.06045816f, 0.26732558f, -0.30848140f, -0.15850070f, 0.11882875f, -0.31225958f, 0.22563213f, -0.08646636f, -0.05693139f, -0.19700758f, 0.10509355f, 0.17163131f, 0.35295224f, -0.23599516f, 0.25990778f, -0.14582063f}},
        {{-0.00506483f, 0.29868677f, -0.53111982f, -0.13736254f, -0.10341417f, -0.19406720f, -0.11297676f, 0.18084900f, 0.15569699f, 0.22484976f, 0.15486729f, -0.16755448f, 0.00852378f, -0.00225862f, -0.00165236f, -0.06089948f, -0.04314608f, 0.00314152f, -0.10437319f, -0.04655446f, 0.03693118f, 0.05391110f, 0.12719040f, -0.05316837f, 0.16162349f, -0.02223778f, 0.08750395f, 0.05994332f, 0.10279056f, 0.01651670f, -0.14720610f, 0.09165493f, 0.03940179f, -0.23432419f, -0.55172837f, 0.12868364f, 0.22733703f, -0.07843284f, -0.14182699f, -0.09101584f, -0.18407981f, 0.26485530f, -0.03073969f, -0.06852045f, -0.18725938f, 0.08012272f, 0.00058186f, 0.19703886f, -0.14404966f, -0.09538537f, -0.25671712f, 0.24138510f, 0.17401256f, -0.12917361f, 0.17168126f, 0.07628014f, -0.06102046f, 0.12431234f, -0.08031732f, -0.03876349f, 0.15081774f, -0.39437526f, -0.03411447f, 0.09721299f}},
        {{-0.18179707f, 0.08125911f, -0.06555215f, 0.17542127f, -0.01266255f, -0.04236840f, 0.07780621f, -0.12394927f, 0.02247865f, -0.14199381f, 0.21174347f, -0.06606911f, -0.00636949f, -0.19420028f, -0.19813606f, -0.01648074f, 0.27503380f, -0.06157908f, 0.00320138f, 0.01050137f, -0.06456243f, 0.21503600f, -0.03936069f, -0.14481093f, 0.21536654f, 0.00902318f, 0.06897343f, -0.15167004f, -0.05433235f, 0.03289484f, 0.05450234f, 0.06375070f, -0.34680900f, 0.10728921f, 0.05102055f, -0.04782541f, 0.36253554f, -0.15237525f, 0.31925142f, -0.06754518f, -0.22757889f, -0.10760390f, 0.20681289f, 0.15932520f, -0.00339827f, 0.15151714f, 0.12368899f, 0.04339771f, -0.04333574f, 0.00316889f, -0.16534828f, 0.25685692f, 0.35501799f, -0.16169283f, 0.13717195f, 0.21253729f, -0.21032318f, 0.11769958f, 0.11434753f, -0.19704655f, 0.11931851f, -0.06916209f, 0.14579284f, 0.05655113f}},
        {{0.26947284f, 0.12594885f, 0.24791731f, 0.20971960f, -0.12167084f, -0.03913451f, -0.61263818f, -0.04275066f, -0.38868859f, -0.18691193f, -0.19811052f, 0.13364282f, 0.14135860f, 0.11494982f, -0.23917662f, -0.09283417f, 0.03232053f, 0.17344865f, -0.15207981f, 0.07135176f, 0.25259602f, 0.19017436f, -0.33499759f, -0.21396559f, 0.39212269f, -0.19870435f, 0.07930122f, -0.19849232f, 0.36595476f, 0.07730404f, 0.12984110f, -0.24102508f, -0.06137358f, -0.08516963f, -0.22532330f, -0.03250252f, 0.19590673f, 0.23632805f, 0.04224956f, -0.10129826f, 0.07443453f, -0.04677005f, -0.12532081f, -0.08460801f, 0.18332008f, 0.06030970f, -0.17511968f, -0.53340250f, -0.46799320f, -0.21422549f, 0.08474886f, -0.05587506f, -0.20924081f, -0.09288684f, 0.02133605f, 0.04163336f, 0.10494259f, -0.15854740f, -0.16627491f, 0.17274475f, 0.28266487f, -0.07534366f, -0.09605061f, -0.23076849f}},
        {{0.62986565f, -0.09608644f, 0.24110046f, 0.16276285f, 0.21233381f, -0.31104049f, -0.32060084f, 0.12326695f, -0.29708651f, -0.15238455f, -0.19101246f, -0.02401139f, 0.01211363f, 0.17453869f, -0.00755746f, 0.41363564f, 0.10748637f, -0.12748437f, 0.01922305f, 0.09243763f, 0.22845356f, -0.37682393f, 0.19120771f, -0.11961371f, 0.08655428f, -0.00244321f, -0.41747734f, 0.36324021f, -0.49091130f, 0.02558104f, -0.19565773f, -0.07913816f, -0.18318696f, -0.57230145f, -0.27281487f, 0.02115218f, 0.08683123f, -0.05803855f, -0.12339027f, -0.49564669f, -0.25064960f, -0.14189394f, 0.05652532f, -0.21666144f, -0.27148992f, -0.01840027f, -0.38908321f, -0.47036055f, 0.49555707f, -0.20753971f, 0.17335573f, 0.19440362f, 0.06891800f, -0.18998636f, -0.06401996f, -0.15734504f, 0.20128800f, 0.22837369f, 0.47247079f, 0.07510877f, 0.52598310f, 0.45863584f, -0.16387354f, -0.06143393f}},
        {{-0.12307155f, -0.11505102f, 0.06389906f, -0.03936656f, -0.50806379f, 0.40471479f, 0.11840660f, -0.34860104f, 0.32875025f, -0.37283406f, -0.14150615f, 0.08185126f, -0.50438428f, 0.18585166f, 0.15723008f, 0.05904631f, -0.38766834f, -0.02105069f, 0.23896894f, 0.10258452f, -0.13786924f, -0.03161308f, 0.01925792f, -0.00768164f, 0.13640977f, -0.20361127f, 0.48531944f, -0.02921052f, 0.53680313f, -0.18296911f, 0.13917649f, 0.54296964f, -0.12726294f, 0.64920264f, 0.42444241f, -0.48826462f, -0.37949175f, 0.26034927f, -0.38309327f, -0.10177764f, -0.41166037f, 0.41329235f, -0.47785273f, 0.43193182f, 0.13309741f, 0.14548069f, 0.36422926f, 0.09147097f, 0.20889989f, -0.36368686f, -0.61998707f, -0.29845342f, -0.20742996f, 0.13702413f, -0.02560454f, -0.50455999f, -0.07121070f, 0.27069196f, -0.06712627f, -0.05392494f, -0.69536674f, -0.18555436f, 0.59202296f, -0.26479062f}},
        {{0.17909305f, 0.11647162f, 0.07728150f, -0.23653963f, 0.51871622f, -0.34401882f, -0.25487244f, 0.29531610f, -0.18927570f, 0.10676098f, -0.01335884f, -0.03948414f, 0.37506476f, -0.16489325f, 0.21424620f, -0.06991913f, -0.40500301f, -0.17230526f, 0.07797844f, -0.17524794f, 0.48835629f, -0.01100193f, 0.04271427f, -0.22346155f, 0.20602526f, 0.17106687f, -0.02941085f, 0.30590010f, -0.31067607f, 0.00817328f, -0.17090809f, -0.30603740f, -0.21707577f, -0.35253397f, -0.03646600f, -0.20722125f, 0.01551693f, -0.27782214f, -0.15251954f, -0.21496111f, -0.33747613f, -0.07896554f, -0.42912838f, -0.00922835f, -0.19149458f, 0.30674356f, -0.20148180f, -0.47981954f, -0.26596057f, -0.19660892f, -0.17879552f, 0.14048986f, 0.05404144f, -0.20109642f, -0.10663684f, 0.05332505f, 0.21817088f, 0.02284387f, 0.03684822f, -0.36486033f, -0.13711272f, 0.35475177f, -0.36398169f, 0.06253373f}},
        {{0.04996244f, 0.10615232f, 0.01380443f, -0.41209659f, 0.05959876f, 0.11666859f, -0.22184502f, -0.19411266f, -0.22571324f, -0.14969042f, 0.25094134f, -0.16144791f, -0.00630613f, 0.02732690f, 0.30113181f, -0.28766355f, -0.26253900f, -0.16587886f, 0.01206353f, 0.03117169f, -0.04147746f, 0.36132467f, -0.38639340f, -0.07705192f, -0.04819322f, 0.23396727f, 0.29465902f, -0.03752878f, -0.21131065f, 0.23862480f, -0.11246002f, 0.05517835f, -0.06077760f, 0.38584334f, 0.14337008f, -0.00851756f, 0.16027820f, 0.09230531f, -0.44118115f, -0.02042700f, -0.12529701f, -0.20138259f, 0.02387811f, 0.01141640f, 0.23334599f, -0.04530024f, 0.08151308f, -0.03176958f, -0.25417197f, 0.17886002f, -0.23446305f, 0.09968816f, -0.06849311f, 0.24638702f, 0.17521158f, 0.11390278f, -0.33097124f, 0.24636079f, -0.45713788f, -0.38380656f, -0.44795105f, -0.14181131f, 0.21497235f, 0.31769836f}},
        {{0.00628657f, 0.11715414f, -0.03663705f, 0.17613797f, 0.33192891f, -0.28320271f, 0.20731241f, 0.23766793f, 0.05963343f, 0.36959383f, -0.03853091f, 0.05941680f, 0.35451823f, -0.12547576f, -0.04071766f, 0.20132405f, 0.37374383f, -0.04960330f, 0.15480711f, 0.13426200f, 0.21051741f, 0.05919496f, 0.10208340f, 0.42300081f, -0.05426238f, -0.02824951f, 0.00250119f, -0.15261126f, 0.16879040f, 0.18798211f, 0.04878762f, 0.21511713f, 0.00548143f, -0.17680727f, -0.02090748f, 0.08476556f, -0.20382826f, 0.03627042f, 0.36494848f, -0.06184305f, 0.16844401f, -0.06383254f, 0.20520908f, -0.09855451f, 0.02441624f, 0.15042061f, -0.13877502f, -0.14838757f, 0.07359207f, 0.17082430f, 0.27765462f, 0.02803151f, 0.07337786f, 0.11478584f, 0.30775002f, 0.33854610f, -0.24806911f, -0.24016613f, -0.19854498f, 0.19091557f, 0.17500037f, 0.07469234f, 0.17556722f, 0.25423902f}},
        {{0.41871858f, 0.47416019f, -0.53237653f, -0.51390141f, -0.01282233f, -0.16598611f, 0.10266142f, 0.12705453f, -0.10186707f, -0.20214343f, 0.15972491f, 0.28455657f, 0.00528306f, -0.12727840f, -0.38240197f, -0.57410872f, 0.31600896f, 0.26168278f, 0.20475863f, 0.06013682f, 0.20969529f, 0.27933303f, -0.23032875f, 0.01497698f, -0.00467982f, 0.07336271f, -0.11902992f, -0.37948743f, 0.21119055f, 0.00473996f, -0.10775735f, -0.15290302f, 0.25687009f, -0.05151061f, -0.07943773f, -0.14574641f, 0.34931570f, -0.31884560f, 0.27754545f, -0.00717511f, 0.25923234f, -0.28393552f, -0.17404528f, -0.00157655f, 0.30165356f, -0.13694501f, -0.17884248f, 0.08724823f, 0.19374394f, 0.61252409f, -0.10262912f, 0.05336370f, -0.11632423f, 0.14352711f, -0.32474104f, 0.27420282f, 0.27235281f, -0.18178351f, 0.08838925f, -0.11607066f, 0.23981760f, -0.01392928f, 0.11027179f, 0.21280228f}},
        {{0.03270293f, -0.00241098f, -0.11891874f, 0.06825203f, -0.06778233f, 0.22639632f, 0.09306898f, 0.04240111f, 0.03327098f, 0.00653640f, 0.05727734f, -0.16337942f, -0.02212001f, -0.14653014f, -0.03579532f, -0.00308533f, -0.05806811f, 0.10197593f, -0.00557354f, -0.02024441f, 0.04301330f, -0.47456565f, 0.19570488f, 0.04348343f, 0.07099105f, -0.10552219f, -0.09703229f, 0.05415367f, 0.03039085f, 0.23313476f, -0.49611509f, -0.20317976f, -0.06310735f, -0.04145339f, -0.10065138f, -0.00463600f, -0.00816487f, 0.01078232f, 0.25684363f, 0.06034466f, 0.04775773f, -0.26353213f, -0.02668156f, -0.21412010f, -0.04126665f, 0.09833328f, -0.03428073f, 0.10428765f, -0.04850717f, 0.16223633f, -0.25006050f, -0.19682960f, 0.01155558f, -0.17241997f, -0.03357969f, -0.09512632f, 0.13243057f, -0.07003203f, -0.17519274f, -0.02721937f, 0.00485263f, -0.01893555f, -0.08973736f, 0.00454074f}},
        {{-0.13385311f, 0.13992162f, 0.06324975f, 0.08156662f, 0.10266265f, -0.54749072f, -0.00331472f, -0.01972160f, 0.07767200f, 0.02646228f, 0.12267325f, -0.02465908f, 0.10617302f, 0.30314454f, 0.22171371f, 0.07628851f, 0.17905478f, 0.06364755f, -0.01530620f, 0.07826392f, 0.04057530f, 0.02837205f, 0.03298432f, 0.25834867f, -0.03032105f, 0.05529764f, 0.10242035f, -0.25924918f, -0.02626847f, -0.32268319f, 0.15198444f, -0.10367763f, -0.02800906f, -0.18421021f, 0.01638130f, -0.06883126f, -0.03766103f, 0.25500679f, -0.11546979f, -0.27217451f, -0.57494783f, -0.23678298f, 0.03531427f, -0.04252119f, -0.36972338f, -0.11885298f, -0.00358898f, 0.01741772f, 0.24973930f, 0.02619887f, 0.00837331f, 0.07345752f, -0.05038637f, 0.08397480f, 0.02352566f, 0.35814536f, -0.02264344f, 0.00480678f, 0.09239756f, 0.03079489f, -0.03131818f, -0.09778417f, -0.13241144f, 0.15122265f}},
        {{-0.09594895f, 0.01879845f, -0.42939961f, -0.04645508f, -0.13919631f, 0.01012217f, -0.10691689f, 0.28601435f, 0.06521440f, 0.09221908f, 0.20533240f, -0.03333286f, 0.08335455f, -0.04342796f, -0.11902552f, 0.17186916f, 0.09899959f, 0.15809804f, -0.10099263f, 0.14371006f, 0.17007084f, -0.39347017f, 0.07982384f, 0.31903365f, -0.15947312f, 0.08890732f, -0.25134811f, -0.06140540f, 0.01050820f, 0.19962381f, 0.10488835f, 0.00368740f, 0.08014090f, 0.02038249f, -0.18284057f, -0.14072613f, -0.09042708f, -0.21811040f, 0.21984386f, 0.22274123f, 0.00831837f, 0.20834997f, 0.18564928f, -0.09372780f, -0.26524970f, 0.17605618f, -0.24879113f, 0.23753671f, 0.19782098f, 0.28470156f, -0.30075553f, -0.06510121f, -0.13400063f, -0.22720924f, -0.04005569f, 0.24348059f, 0.15572043f, -0.16784020f, -0.04775384f, -0.01982266f, 0.24457720f, -0.18043813f, 0.37855828f, -0.00835006f}},
        {{-0.03779763f, 0.22839488f, -0.10028186f, 0.14193574f, -0.21498187f, 0.18120626f, -0.05293734f, 0.35395023f, 0.12307812f, 0.18121885f, 0.14788371f, -0.07925724f, -0.12886506f, -0.04595883f, -0.14272533f, 0.12185188f, 0.04867140f, 0.28219107f, 0.13574098f, 0.16821003f, -0.23366378f, 0.10721042f, 0.19169641f, -0.02088364f, -0.02260693f, 0.13582219f, -0.29816809f, -0.07410201f, -0.03167564f, -0.24317670f, -0.05374878f, -0.16596234f, -0.26117632f, -0.12560588f, 0.27426726f, 0.03298260f, 0.16949168f, -0.06430989f, -0.11893851f, -0.03492216f, -0.04697277f, -0.23388688f, 0.14570361f, -0.10706358f, -0.06429208f, -0.04023188f, -0.25897357f, -0.33787167f, 0.17684157f, -0.04864889f, -0.34230095f, 0.16957897f, -0.16833533f, 0.08919825f, 0.25477457f, -0.15113606f, -0.09562097f, -0.19768344f, -0.03144129f, -0.09898070f, -0.04384205f, -0.19465227f, -0.09763310f, 0.24002142f}},
        {{-0.15656014f, 0.07607326f, -0.05645667f, -0.04074693f, 0.01033185f, -0.04937192f, -0.11765715f, 0.32085553f, -0.06961732f, -0.07976504f, -0.01314422f, -0.06708055f, 0.14493203f, 0.08243557f, 0.13779458f, -0.19256228f, 0.02809707f, 0.03851930f, -0.16176131f, -0.06852959f, 0.11188933f, -0.24819289f, 0.05849842f, -0.18053731f, -0.31851304f, -0.11510984f, 0.09047237f, 0.08458639f, 0.28135231f, -0.10879315f, -0.15124092f, 0.04774260f, -0.02262286f, 0.19089270f, -0.11079510f, -0.02459759f, -0.25780359f, -0.08524770f, 0.02543973f, -0.01749652f, -0.13380682f, -0.10364128f, 0.03825144f, 0.13527323f, 0.08759886f, 0.08454407f, 0.04259380f, -0.18799257f, 0.17850152f, -0.00977186f, -0.23773696f, 0.12208669f, -0.21089664f, 0.16620973f, 0.03974446f, 0.07275963f, 0.17425539f, 0.14835823f, 0.16172943f, 0.10081592f, -0.26121503f, 0.00872136f, -0.23929328f, 0.10198224f}},
        {{0.13351500f, -0.02570412f, -0.11832580f, 0.01898852f, 0.04579485f, -0.18188031f, 0.14891344f, -0.07668348f, 0.06587984f, 0.14706920f, -0.12725531f, 0.12706931f, 0.13491996f, 0.03576710f, 0.11400124f, -0.18397912f, -0.29897979f, -0.03739803f, 0.05218819f, 0.09824494f, -0.11117752f, -0.23730744f, -0.04718110f, -0.04671491f, -0.06904173f, 0.18372498f, -0.09446638f, 0.18243989f, -0.15916440f, -0.17107277f, 0.09080133f, 0.04398198f, -0.08608746f, -0.03516172f, -0.08302579f, 0.15963216f, 0.19757862f, -0.08010981f, 0.09708090f, 0.13391136f, 0.06515321f, 0.14126246f, 0.05798276f, 0.03977814f, 0.09802059f, -0.00864450f, 0.12545598f, -0.15095329f, 0.09081784f, -0.11184156f, 0.00321101f, 0.16504374f, 0.13625936f, -0.12251635f, -0.33577207f, -0.06695605f, 0.19568446f, 0.10762249f, -0.19090733f, 0.04046503f, 0.10886563f, 0.10818332f, 0.15639184f, 0.07214330f}},
        {{-0.04926343f, -0.15390503f, 0.12928255f, 0.06971335f, 0.04535962f, 0.15397938f, 0.13455857f, -0.02329247f, 0.72082561f, 0.22922246f, 0.00382530f, -0.17745744f, -0.28438690f, 0.16476107f, -0.23435161f, 0.09610040f, -0.06321660f, 0.13031800f, -0.05818146f, -0.03267801f, 0.26594332f, -0.16874248f, 0.15024421f, -0.13892491f, -0.23261702f, -0.03580366f, 0.08656430f, 0.33578470f, -0.63022059f, -0.06076890f, -0.19956948f, -0.17456727f, 0.20083645f, 0.07461951f, -0.07824086f, -0.00364017f, 0.26723862f, -0.18601565f, 0.15212709f, 0.18271442f, -0.06104250f, 0.02731620f, 0.06227786f, -0.03027929f, -0.03699326f, -0.28736278f, 0.13884683f, 0.04582049f, 0.29274350f, -0.00516292f, 0.36315319f, -0.02066411f, -0.25135142f, -0.35654068f, 0.00023031f, 0.01734180f, 0.11793202f, -0.01250155f, 0.03793379f, 0.03168011f, 0.22710593f, 0.01959399f, 0.01643321f, -0.10615522f}},
        {{-0.11923417f, -0.23037870f, 0.05736158f, -0.30601820f, 0.18464854f, -0.20644926f, 0.25419495f, 0.22492045f, -0.02035570f, -0.06718715f, 0.38851011f, 0.06976073f, 0.07978052f, 0.01955287f, 0.31209013f, 0.04489622f, -0.09900083f, 0.14199346f, 0.09173471f, -0.22025377f, 0.03542706f, 0.07165904f, 0.05406943f, -0.00836413f, 0.21292427f, -0.01407351f, 0.14959992f, -0.39150682f, 0.00371018f, -0.23212720f, -0.12701643f, -0.33549240f, 0.10753344f, 0.43469572f, 0.41762200f, 0.14023551f, 0.13699037f, 0.05021367f, 0.01603330f, 0.41418397f, -0.12061711f, -0.13591117f, 0.01954675f, -0.15275118f, 0.06879305f, 0.05789871f, 0.08758860f, -0.16628669f, -0.26836360f, -0.08430504f, -0.27168608f, 0.11729263f, 0.01437844f, -0.00885234f, 0.01036286f, 0.26990038f, -0.08775771f, 0.07302215f, -0.01782269f, 0.06913306f, -0.25176689f, 0.07644573f, 0.16735992f, -0.03175413f}},
        {{-0.29887584f, -0.10986734f, 0.06464289f, -0.01774739f, 0.24278726f, -0.06011591f, 0.02570735f, -0.42177829f, 0.26474926f, -0.20511378f, 0.12275786f, -0.03734938f, 0.32864702f, -0.46683544f, -0.27947840f, 0.10092300f, -0.16374050f, -0.16729350f, -0.01590874f, 0.05649276f, -0.18113224f, -0.06882693f, 0.10935076f, 0.22853532f, -0.08381205f, 0.17722778f, -0.29610521f, 0.24007224f, -0.05124689f, -0.10822812f, -0.20794004f, 0.13141972f, -0.36099544f, -0.35649759f, -0.34680045f, -0.08323379f, 0.17584078f, -0.21185425f, 0.08335830f, -0.40789267f, 0.13217501f, -0.14212725f, 0.05378161f, 0.36607078f, -0.17001422f, 0.02108515f, -0.23437452f, -0.06860146f, 0.08370619f, 0.13794427f, 0.20852157f, -0.17047472f, -0.16397342f, -0.20093371f, -0.18163443f, 0.08535125f, 0.34015763f, -0.00506868f, 0.09772632f, -0.22479568f, 0.35762414f, 0.10026664f, -0.24881673f, 0.33542669f}},
        {{0.10306045f, -0.29705390f, -0.04090413f, 0.19685699f, -0.15139513f, 0.18038957f, 0.17098533f, 0.11490615f, -0.12646377f, 0.09139678f, -0.21854733f, 0.07523586f, -0.25158900f, 0.14227621f, -0.03148598f, -0.07827926f, -0.18027788f, 0.14002651f, -0.17455554f, -0.05008825f, -0.18662702f, -0.13816163f, 0.17522547f, 0.06823888f, -0.32167462f, 0.05713202f, 0.24208972f, 0.15953308f, 0.09112848f, -0.01717443f, 0.39539444f, 0.18475260f, 0.02433292f, -0.15936522f, 0.09059945f, 0.28885892f, -0.08762952f, 0.21646145f, 0.02114060f, 0.12020312f, -0.02796603f, -0.07497296f, 0.25743172f, 0.10190786f, -0.10129066f, 0.12642187f, 0.01216896f, 0.25540614f, 0.19802547f, 0.00130500f, 0.27969888f, -0.02123774f, 0.22920842f, -0.13495991f, -0.13279577f, 0.03581927f, -0.02149023f, -0.30618793f, 0.29363838f, 0.40649712f, -0.08219191f, 0.19932732f, -0.09944530f, -0.24433221f}},
        {{0.00392567f, 0.13388397f, 0.06151387f, 0.06971128f, -0.05011035f, 0.04690699f, -0.31235272f, 0.06898735f, 0.13455625f, -0.00097336f, -0.12423321f, -0.03098500f, 0.17751627f, 0.16737682f, -0.14969343f, -0.13640177f, 0.19174886f, -0.02342670f, -0.22758994f, -0.18673608f, -0.11536298f, -0.09697340f, 0.17426440f, 0.27343312f, -0.33328590f, 0.05968034f, -0.21056509f, 0.28022563f, 0.21437657f, 0.13115457f, 0.14775416f, 0.05498919f, 0.07870640f, -0.00127695f, -0.06014940f, 0.01874841f, -0.09404255f, 0.21917933f, 0.05184730f, -0.28236094f, -0.02441043f, 0.19475392f, -0.04453054f, -0.13021979f, -0.16881892f, -0.02073889f, -0.09281354f, 0.23504785f, 0.25734174f, -0.04866721f, 0.02870580f, 0.19500169f, -0.06181578f, 0.15819108f, 0.02197774f, -0.23808475f, -0.01275294f, -0.25277933f, 0.25653929f, -0.03885635f, -0.08589575f, 0.19122458f, -0.20027423f, 0.11976498f}},
        {{0.32831857f, -0.03661737f, 0.03092062f, 0.00141313f, -0.01228786f, -0.15140724f, -0.13780783f, -0.00501697f, 0.01899844f, 0.27775761f, 0.16758239f, 0.22979157f, -0.22105068f, -0.02753419f, -0.27248347f, -0.10901159f, 0.05234332f, -0.09387065f, -0.30844977f, -0.11240511f, -0.11665872f, -0.08360665f, 0.08931234f, -0.17685787f, 0.23123461f, -0.51732230f, 0.00306244f, -0.18518329f, -0.07781151f, 0.01286826f, 0.04779355f, -0.08815675f, -0.14113793f, 0.09292625f, 0.05239869f, 0.03776926f, -0.16475315f, 0.27461913f, -0.06906891f, 0.04034154f, -0.00276540f, -0.05134443f, 0.21655348f, -0.05567675f, 0.06418768f, 0.07999963f, -0.00299855f, -0.05558524f, -0.03219676f, -0.04981922f, -0.23998992f, 0.09143495f, -0.24805814f, -0.04057212f, 0.00300683f, -0.05902637f, 0.19355121f, 0.17226987f, 0.00319558f, 0.22135210f, 0.19962582f, -0.19656222f, 0.04480640f, -0.17169365f}},
        {{0.03334586f, -0.45178977f, 0.31391621f, 0.65663207f, 0.00933869f, 0.02619722f, -0.31733099f, 0.26021069f, 0.04144656f, -0.20439862f, -0.50878054f, -0.20744166f, -0.02994869f, 0.17621882f, 0.32852924f, 0.15362300f, 0.03321093f, -0.36630082f, -0.25169536f, 0.36491898f, 0.13718350f, 0.03997716f, 0.48342487f, 0.14283855f, -0.06591092f, -0.13689131f, 0.12646645f, 0.07078858f, -0.24764805f, -0.06640093f, -0.34295943f, 0.08475851f, -0.06486593f, -0.17908998f, 0.34284464f, 0.42184067f, -0.07157314f, 0.24907964f, 0.04440716f, 0.05712543f, -0.05598099f, 0.17077599f, 0.14732726f, -0.33432516f, -0.44158226f, -0.05643480f, 0.25655848f, -0.05968652f, 0.16342109f, -0.62752271f, 0.17435658f, -0.01901267f, -0.09490617f, 0.07729845f, -0.33719489f, -0.36693749f, -0.17279114f, -0.36573762f, -0.00249673f, 0.15976274f, 0.26713741f, 0.06585477f, -0.12432053f, -0.26554680f}},
        {{0.21551678f, -0.04390476f, -0.16848785f, 0.05946128f, 0.00557707f, -0.23219572f, -0.03157455f, 0.03074227f, 0.01789201f, 0.12372676f, 0.24087182f, -0.19579048f, -0.13681103f, -0.07005072f, 0.02110660f, 0.07110189f, 0.14515133f, 0.06824034f, 0.02089335f, -0.11174002f, 0.08355894f, 0.06170925f, 0.04033935f, -0.19124901f, 0.08480377f, -0.10049134f, -0.12441188f, -0.06446423f, 0.06676476f, -0.03082396f, -0.19864495f, -0.00105431f, -0.00228226f, -0.08027095f, -0.11775003f, -0.03079452f, 0.16597682f, -0.05415412f, -0.32609525f, 0.07041655f, 0.14055897f, 0.00407796f, 0.07805490f, -0.05872837f, 0.11507681f, -0.14596842f, 0.03703772f, 0.21723264f, -0.13513149f, 0.16289908f, 0.21397541f, -0.22580354f, 0.10862405f, -0.18307930f, -0.09640222f, -0.17525816f, -0.16571227f, -0.03880136f, -0.00590586f, 0.01207583f, 0.00910967f, -0.33079979f, -0.07722348f, -0.04148173f}},
        {{-0.01711489f, 0.15548903f, 0.00133349f, 0.06368815f, 0.13522308f, 0.12070016f, 0.10254236f, -0.15683302f, 0.00118142f, 0.15342441f, 0.04905404f, -0.01030327f, -0.04681785f, -0.01006596f, 0.28128791f, -0.05270734f, -0.22811733f, 0.05917948f, -0.20173492f, 0.13480982f, 0.02034093f, -0.00507851f, 0.10820026f, -0.24852583f, -0.04714901f, -0.26093131f, 0.19164379f, -0.01278513f, -0.06274733f, -0.10853305f, 0.04475490f, 0.01150226f, 0.00175107f, -0.17427246f, -0.03856577f, -0.09934835f, 0.10194729f, 0.04228881f, -0.08103272f, -0.25595638f, 0.25872135f, 0.04183413f, 0.09647062f, -0.24953228f, 0.06871282f, -0.20903257f, 0.05632756f, 0.13689779f, -0.05629973f, -0.25820982f, -0.20657359f, -0.05503054f, -0.04707876f, -0.25067887f, 0.14412926f, -0.13965949f, -0.15980992f, 0.06580847f, -0.13912508f, 0.40322852f, -0.03210638f, 0.00434515f, -0.06392723f, 0.12569316f}},
        {{-0.04159402f, -0.03768822f, 0.22666509f, -0.11325709f, -0.08819699f, -0.04313138f, 0.02285998f, 0.01187021f, -0.02499611f, 0.05645326f, 0.13461104f, 0.17000461f, 0.04062798f, -0.09337041f, -0.10270398f, -0.11378075f, -0.08693574f, -0.01431026f, -0.03672525f, 0.23616242f, -0.03299937f, -0.13486297f, 0.03045922f, -0.18454550f, -0.09891643f, 0.07072713f, -0.15004870f, -0.12154961f, 0.24843056f, 0.09953618f, 0.06666581f, 0.07059566f, 0.01842078f, -0.09443360f, 0.00723328f, -0.20742294f, -0.06143481f, -0.01235681f, -0.15860409f, 0.18070702f, 0.17435113f, 0.05616822f, 0.09501729f, 0.20142925f, -0.29466140f, 0.02401070f, -0.27179554f, 0.00689326f, -0.06028565f, 0.14802876f, 0.07162850f, -0.22746770f, 0.02229309f, 0.22346149f, 0.01941617f, 0.14360894f, 0.11404420f, -0.07933424f, -0.03964677f, -0.05114912f, -0.01101890f, -0.04746111f, -0.09675844f, 0.00247746f}},
        {{0.02309878f, 0.03183854f, -0.01180986f, 0.04829641f, 0.09977300f, 0.02124103f, -0.14897595f, -0.01741432f, -0.00751872f, -0.02659482f, 0.04015133f, -0.16695952f, 0.10423519f, -0.01998512f, 0.08488251f, -0.00686513f, -0.07234924f, 0.02163619f, 0.13489789f, -0.05885330f, -0.09738123f, -0.10796990f, 0.13977213f, 0.04069801f, 0.13470842f, -0.35142830f, 0.02879395f, 0.06075406f, 0.00604695f, -0.06417807f, -0.23627789f, -0.06747919f, 0.07779151f, 0.11265515f, -0.00732383f, -0.09562217f, 0.03096161f, -0.18499281f, 0.10549703f, 0.07011792f, 0.16156219f, -0.10136191f, -0.01189352f, 0.05542864f, 0.06285770f, 0.11373971f, -0.05798312f, -0.06733334f, -0.09703459f, 0.05931902f, -0.09575978f, 0.09878099f, -0.12764823f, -0.35031843f, 0.22229309f, 0.09308036f, 0.07056585f, 0.01831160f, -0.06291173f, 0.24862835f, 0.05362075f, 0.03341649f, 0.02805840f, -0.06538075f}},
        {{-0.00000000f, -0.00000000f, -0.00000000f, -0.00000000f, -0.00000000f, 0.00000000f, 0.00000000f, 0.00000000f, 0.00000000f, 0.00000000f, -0.00000000f, 0.00000000f, -0.00000000f, 0.00000000f, 0.00000000f, -0.00000000f, 0.00000000f, 0.00000000f, -0.00000000f, 0.00000000f, -0.00000000f, 0.00000000f, -0.00000000f, 0.00000000f, 0.00000000f, -0.00000000f, 0.00000000f, 0.00000000f, 0.00000000f, 0.00000000f, 0.00000000f, -0.00000000f, 0.00000000f, -0.00000000f, 0.00000000f, 0.00000000f, -0.00000000f, 0.00000000f, 0.00000000f, -0.00000000f, 0.00000000f, 0.00000000f, 0.00000000f, -0.00000000f, 0.00000000f, 0.00000000f, -0.00000000f, -0.00000000f, 0.00000000f, 0.00000000f, 0.00000000f, 0.00000000f, -0.00000000f, 0.00000000f, -0.00000000f, 0.00000000f, 0.00000000f, -0.00000000f, -0.00000000f, 0.00000000f, -0.00000000f, 0.00000000f, 0.00000000f, -0.00000000f}},
        {{0.21001719f, 0.15701157f, -0.20475905f, 0.14933485f, 0.03135218f, -0.08475839f, 0.05922392f, -0.07897798f, -0.18317600f, -0.19402611f, 0.08949805f, 0.06562211f, 0.15100551f, 0.12322252f, 0.20069626f, 0.06535019f, -0.21596213f, -0.24427122f, 0.06095012f, 0.05208654f, -0.15299742f, -0.00277561f, 0.22262390f, 0.01498531f, 0.04094580f, -0.03130007f, 0.00751234f, 0.01350289f, -0.07728330f, -0.13097592f, 0.11732870f, -0.07725938f, 0.18972729f, 0.11877910f, -0.19194064f, 0.06452537f, 0.03686073f, 0.21127462f, -0.10397940f, 0.12155028f, 0.06923251f, -0.04796062f, -0.25070578f, 0.04464087f, 0.23305814f, 0.02458564f, 0.16323808f, 0.08217959f, 0.05510853f, -0.11206424f, 0.31818095f, -0.03711206f, -0.10211431f, -0.20511210f, -0.20999154f, 0.03549827f, -0.18151435f, 0.17758049f, -0.28852355f, -0.14437740f, 0.05774978f, -0.22224177f, -0.07518074f, -0.04676378f}},
        {{-0.45220822f, 0.09179468f, -0.02637739f, -0.09339084f, 0.28595385f, 0.02695650f, 0.42934176f, 0.12264610f, -0.16282822f, 0.29075068f, 0.05143270f, 0.23123276f, -0.36888066f, 0.14647897f, -0.11762369f, -0.62322038f, -0.05325883f, 0.34227020f, -0.47335404f, -0.10264621f, 0.35135144f, -0.38207182f, 0.47775838f, -0.19442625f, -0.27120450f, -0.14057732f, -0.20890753f, -0.23333175f, 0.30101663f, 0.25986573f, 0.00769814f, -0.34722966f, 0.53450644f, 0.26951459f, 0.20728087f, 0.01791206f, 0.17942064f, 0.11865155f, -0.41992036f, -0.06123791f, -0.35231194f, 0.06934781f, 0.03189245f, 0.06338139f, -0.19775736f, 0.25965488f, 0.30972609f, 0.25978249f, 0.19249974f, 0.16937204f, -0.05852692f, -0.41815528f, -0.30320475f, -0.61006594f, 0.05168787f, -0.01795275f, -0.06452965f, 0.35367462f, 0.27072108f, -0.26489487f, 0.18419607f, -0.10915598f, 0.28800866f, -0.41431585f}}
    }};
    return W1;
}

inline const std::array<float, HIDDEN_SIZE>& get_B1() {
    static const std::array<float, HIDDEN_SIZE> B1 = {{
        0.05010954f, -0.66797835f, 0.49104694f, 0.43956739f, 0.00063612f, 0.43075967f, -0.10431801f, -1.16678202f, -0.84495246f, -0.68435329f, 0.36922517f, -0.45720744f, -0.78644311f, 0.21543166f, 0.03066675f, -0.61961573f, 0.16538961f, -0.44256881f, -0.17598706f, -1.02829278f, 0.17095794f, 0.35042369f, -0.14479746f, -0.74739933f, -0.53819782f, -0.36862373f, 0.40452603f, -0.06537852f, -0.70746797f, 0.01446337f, 0.23256381f, -0.06595241f, 0.33750725f, -0.45538452f, 0.60896522f, -0.28317153f, 0.30679208f, 0.11750530f, -0.03365374f, 0.62131941f, 0.43873763f, -0.06934756f, -0.62591004f, 0.49160090f, 0.17705055f, -0.25164759f, 0.41857731f, -0.38153005f, -0.42655042f, -0.02117529f, 0.34734944f, 0.22735806f, -0.16697000f, 0.25576374f, -0.17397036f, -0.39956573f, -0.38686940f, -0.00503302f, -0.39942715f, -0.45513296f, -0.34279883f, 0.07740697f, -0.65514445f, 0.06278398f
    }};
    return B1;
}

inline const std::array<float, HIDDEN_SIZE>& get_W2() {
    static const std::array<float, HIDDEN_SIZE> W2 = {{
        -0.24137756f, -0.51257175f, -0.31930476f, -0.30590287f, 0.27516103f, -0.17389749f, 0.20631750f, -0.91884923f, -0.52413052f, 0.41140082f, 0.30647144f, -0.26345876f, -0.39359576f, -0.19274864f, -0.12154981f, 0.37625948f, -0.15438108f, -0.20045792f, -0.13551043f, 0.71153355f, 0.37500510f, -0.22843121f, 0.22293502f, -0.22902259f, -0.27726498f, 0.17744496f, 0.40155339f, 0.30143443f, 0.43505868f, -0.11893118f, 0.18730290f, -0.33771923f, 0.18164402f, -0.49406317f, 0.27573761f, -0.29815656f, -0.25768736f, 0.17015253f, -0.24730162f, 0.25003406f, -0.24506040f, -0.21521129f, -0.36329746f, -0.32677096f, 0.28000802f, -0.02657643f, 0.31439513f, 0.22418556f, 0.25220671f, 0.26405096f, 0.20390613f, 0.17343539f, -0.11899117f, -0.18104613f, 0.17429575f, 0.32816824f, 0.15425457f, -0.10081301f, 0.19825125f, -0.17534171f, 0.38595033f, -0.16528210f, 0.39851871f, -0.19969858f
    }};
    return W2;
}

inline float get_B2() { return -0.21383321f; }

// Helper: reverse complement
inline char complement(char c) {
    switch (c) {
        case 'A': case 'a': return 'T';
        case 'T': case 't': return 'A';
        case 'G': case 'g': return 'C';
        case 'C': case 'c': return 'G';
        default: return 'N';
    }
}

inline std::string reverse_complement(const std::string& seq) {
    std::string rc(seq.length(), 'N');
    for (size_t i = 0; i < seq.length(); ++i) {
        rc[i] = complement(seq[seq.length() - 1 - i]);
    }
    return rc;
}

// Count internal stop codons
inline int count_internal_stops(const std::string& seq, int frame) {
    int stops = 0;
    int n_codons = 0;
    for (size_t i = frame; i + 2 < seq.length(); i += 3) {
        char c1 = std::toupper(seq[i]);
        char c2 = std::toupper(seq[i+1]);
        char c3 = std::toupper(seq[i+2]);
        n_codons++;
        bool is_stop = (c1=='T' && c2=='A' && c3=='A') ||
                       (c1=='T' && c2=='A' && c3=='G') ||
                       (c1=='T' && c2=='G' && c3=='A');
        if (is_stop && i + 5 < seq.length()) stops++;  // internal only
    }
    return stops;
}

// Compute hexamer-like score
inline float compute_hexamer_score(const std::string& seq, int frame) {
    float score = 0.0f;
    int count = 0;
    for (size_t i = frame; i + 5 < seq.length(); i += 3) {
        int gc = 0;
        bool valid = true;
        for (int j = 0; j < 6; j++) {
            char c = std::toupper(seq[i+j]);
            if (c != 'A' && c != 'C' && c != 'G' && c != 'T') { valid = false; break; }
            if (c == 'G' || c == 'C') gc++;
        }
        if (valid) {
            score += 1.0f - std::abs(gc - 3) * 0.1f;
            count++;
        }
    }
    return count > 0 ? score / count : 0.0f;
}

// RNY compliance score
inline float compute_rny_score(const std::string& seq, int frame) {
    int count = 0, total = 0;
    for (size_t i = frame; i + 2 < seq.length(); i += 3) {
        char pos1 = std::toupper(seq[i]);
        char pos3 = std::toupper(seq[i+2]);
        if ((pos1 == 'A' || pos1 == 'C' || pos1 == 'G' || pos1 == 'T') &&
            (pos3 == 'A' || pos3 == 'C' || pos3 == 'G' || pos3 == 'T')) {
            total++;
            if ((pos1 == 'A' || pos1 == 'G') && (pos3 == 'C' || pos3 == 'T')) count++;
        }
    }
    return total > 0 ? (float)count / total : 0.0f;
}

// GC content by codon position
inline void compute_gc_by_position(const std::string& seq, int frame, float gc_pos[3]) {
    int gc[3] = {0, 0, 0};
    int total[3] = {0, 0, 0};
    for (size_t i = frame; i < seq.length(); i++) {
        int pos = (i - frame) % 3;
        char c = std::toupper(seq[i]);
        if (c == 'A' || c == 'C' || c == 'G' || c == 'T') {
            total[pos]++;
            if (c == 'G' || c == 'C') gc[pos]++;
        }
    }
    for (int p = 0; p < 3; p++) {
        gc_pos[p] = total[p] > 0 ? (float)gc[p] / total[p] : 0.0f;
    }
}

// Find best frame for a sequence
inline int best_frame(const std::string& seq) {
    int best = 0;
    float best_score = -1000.0f;
    for (int frame = 0; frame < 3; frame++) {
        int stops = count_internal_stops(seq, frame);
        float hex = compute_hexamer_score(seq, frame);
        float rny = compute_rny_score(seq, frame);
        float score = -stops * 10.0f + hex + rny;
        if (score > best_score) { best_score = score; best = frame; }
    }
    return best;
}

// Extract 43 features for strand classification
inline std::array<float, INPUT_SIZE> extract_features(const std::string& seq) {
    std::array<float, INPUT_SIZE> features;
    features.fill(0.0f);
    std::string rc = reverse_complement(seq);
    
    int idx = 0;
    const std::string* strands[2] = {&seq, &rc};
    
    // Features for each strand
    for (int s = 0; s < 2; s++) {
        const std::string& strand = *strands[s];
        int bf = best_frame(strand);
        
        int stops = count_internal_stops(strand, bf);
        features[idx++] = std::min(stops, 5) / 5.0f;
        features[idx++] = stops > 0 ? 1.0f : 0.0f;
        
        features[idx++] = compute_hexamer_score(strand, bf);
        features[idx++] = compute_rny_score(strand, bf);
        
        float gc_pos[3];
        compute_gc_by_position(strand, bf, gc_pos);
        features[idx++] = gc_pos[0];
        features[idx++] = gc_pos[1];
        features[idx++] = gc_pos[2];
        features[idx++] = gc_pos[2] - gc_pos[0];  // GC3 - GC1
        
        // Dipeptide entropy (simplified)
        features[idx++] = 0.5f;  // Placeholder - compute if needed
        
        // Hydrophobic fraction (simplified)
        features[idx++] = 0.3f;  // Placeholder
        
        // Start/stop presence
        bool has_atg = (bf + 2 < strand.length() &&
                        std::toupper(strand[bf]) == 'A' &&
                        std::toupper(strand[bf+1]) == 'T' &&
                        std::toupper(strand[bf+2]) == 'G');
        features[idx++] = has_atg ? 1.0f : 0.0f;
        
        // Terminal stop
        size_t last_codon = ((strand.length() - bf) / 3 - 1) * 3 + bf;
        bool has_term_stop = false;
        if (last_codon + 2 < strand.length()) {
            char c1 = std::toupper(strand[last_codon]);
            char c2 = std::toupper(strand[last_codon+1]);
            char c3 = std::toupper(strand[last_codon+2]);
            has_term_stop = (c1=='T' && c2=='A' && (c3=='A' || c3=='G')) ||
                           (c1=='T' && c2=='G' && c3=='A');
        }
        features[idx++] = has_term_stop ? 1.0f : 0.0f;
        
        // Min stops across all frames
        int min_stops = std::min({count_internal_stops(strand, 0),
                                  count_internal_stops(strand, 1),
                                  count_internal_stops(strand, 2)});
        features[idx++] = min_stops / 5.0f;
    }
    
    // Difference features (fwd - rc)
    int n_per_strand = idx / 2;
    for (int i = 0; i < n_per_strand; i++) {
        features[idx++] = features[i] - features[n_per_strand + i];
    }
    
    // Additional comparative features
    float best_fwd_hex = std::max({compute_hexamer_score(seq, 0),
                                    compute_hexamer_score(seq, 1),
                                    compute_hexamer_score(seq, 2)});
    float best_rc_hex = std::max({compute_hexamer_score(rc, 0),
                                   compute_hexamer_score(rc, 1),
                                   compute_hexamer_score(rc, 2)});
    features[idx++] = best_fwd_hex - best_rc_hex;
    
    float best_fwd_rny = std::max({compute_rny_score(seq, 0),
                                    compute_rny_score(seq, 1),
                                    compute_rny_score(seq, 2)});
    float best_rc_rny = std::max({compute_rny_score(rc, 0),
                                   compute_rny_score(rc, 1),
                                   compute_rny_score(rc, 2)});
    features[idx++] = best_fwd_rny - best_rc_rny;
    
    int min_fwd_stops = std::min({count_internal_stops(seq, 0),
                                   count_internal_stops(seq, 1),
                                   count_internal_stops(seq, 2)});
    int min_rc_stops = std::min({count_internal_stops(rc, 0),
                                  count_internal_stops(rc, 1),
                                  count_internal_stops(rc, 2)});
    features[idx++] = (min_rc_stops - min_fwd_stops) / 5.0f;
    
    // GC skew
    int g_count = 0, c_count = 0;
    for (char c : seq) {
        if (c == 'G' || c == 'g') g_count++;
        else if (c == 'C' || c == 'c') c_count++;
    }
    features[idx++] = (g_count + c_count) > 0 ?
        (float)(g_count - c_count) / (g_count + c_count) : 0.0f;
    
    return features;
}

// Predict strand: returns probability that FORWARD strand is correct
inline float predict_strand(const std::array<float, INPUT_SIZE>& features) {
    const auto& INPUT_MEAN = get_input_mean();
    const auto& INPUT_STD = get_input_std();
    const auto& W1 = get_W1();
    const auto& B1 = get_B1();
    const auto& W2 = get_W2();
    float B2 = get_B2();
    
    // Normalize input
    std::array<float, INPUT_SIZE> x;
    for (int i = 0; i < INPUT_SIZE; i++) {
        x[i] = (features[i] - INPUT_MEAN[i]) / INPUT_STD[i];
    }
    
    // Hidden layer with ReLU
    std::array<float, HIDDEN_SIZE> h;
    for (int j = 0; j < HIDDEN_SIZE; j++) {
        float sum = B1[j];
        for (int i = 0; i < INPUT_SIZE; i++) {
            sum += x[i] * W1[i][j];
        }
        h[j] = std::max(0.0f, sum);
    }
    
    // Output with sigmoid
    float z = B2;
    for (int j = 0; j < HIDDEN_SIZE; j++) {
        z += h[j] * W2[j];
    }
    return 1.0f / (1.0f + std::exp(-std::clamp(z, -20.0f, 20.0f)));
}

// Convenience: predict strand directly from sequence
inline float predict_strand(const std::string& seq) {
    auto features = extract_features(seq);
    return predict_strand(features);
}

} // namespace strand_nn
} // namespace agp
