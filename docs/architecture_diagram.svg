<?xml version="1.0" encoding="UTF-8"?>
<svg width="800" height="200" viewBox="0 0 800 200" xmlns="http://www.w3.org/2000/svg">
  <defs>
    <style>
      .box { fill: #ffffff; stroke: #333333; stroke-width: 1.2; }
      .box-accent { fill: #f0f4f8; stroke: #333333; stroke-width: 1.2; }
      .cluster { fill: none; stroke: #666666; stroke-width: 1; stroke-dasharray: 4,2; }
      .arrow { fill: none; stroke: #333333; stroke-width: 1; marker-end: url(#arrowhead); }
      .arrow-dashed { fill: none; stroke: #666666; stroke-width: 1; stroke-dasharray: 4,2; marker-end: url(#arrowhead-gray); }
      .label { font-family: Helvetica, Arial, sans-serif; font-size: 11px; fill: #1a1a1a; text-anchor: middle; }
      .label-small { font-family: Helvetica, Arial, sans-serif; font-size: 9px; fill: #666666; text-anchor: middle; }
      .cluster-label { font-family: Helvetica, Arial, sans-serif; font-size: 10px; fill: #333333; font-weight: 500; }
    </style>
    <marker id="arrowhead" markerWidth="8" markerHeight="6" refX="7" refY="3" orient="auto">
      <polygon points="0 0, 8 3, 0 6" fill="#333333"/>
    </marker>
    <marker id="arrowhead-gray" markerWidth="8" markerHeight="6" refX="7" refY="3" orient="auto">
      <polygon points="0 0, 8 3, 0 6" fill="#666666"/>
    </marker>
  </defs>

  <!-- Background -->
  <rect width="800" height="200" fill="#ffffff"/>

  <!-- Pass 1 cluster -->
  <rect x="20" y="30" width="300" height="150" rx="3" class="cluster"/>
  <text x="30" y="48" class="cluster-label">Pass 1: Sample Profiling</text>

  <!-- Pass 2 cluster -->
  <rect x="380" y="30" width="400" height="150" rx="3" class="cluster"/>
  <text x="390" y="48" class="cluster-label">Pass 2: Gene Prediction</text>

  <!-- Pass 1 nodes -->
  <!-- FASTQ -->
  <rect x="40" y="95" width="50" height="28" rx="3" class="box"/>
  <text x="65" y="113" class="label">FASTQ</text>

  <!-- Channel A -->
  <rect x="120" y="65" width="70" height="36" rx="3" class="box-accent"/>
  <text x="155" y="80" class="label">Channel A</text>
  <text x="155" y="93" class="label-small">T/(T+C)</text>

  <!-- Channel B -->
  <rect x="120" y="115" width="70" height="36" rx="3" class="box-accent"/>
  <text x="155" y="130" class="label">Channel B</text>
  <text x="155" y="143" class="label-small">stop conv.</text>

  <!-- Profile output -->
  <rect x="230" y="85" width="70" height="36" rx="3" class="box"/>
  <text x="265" y="100" class="label">Profile</text>
  <text x="265" y="113" class="label-small">d_max, Î»</text>

  <!-- Pass 1 arrows -->
  <path d="M 90 105 L 90 83 L 118 83" class="arrow"/>
  <path d="M 90 115 L 90 133 L 118 133" class="arrow"/>
  <path d="M 192 83 L 210 83 L 210 100 L 228 100" class="arrow"/>
  <path d="M 192 133 L 210 133 L 210 108 L 228 108" class="arrow"/>

  <!-- Pass 2 nodes -->
  <!-- FASTQ -->
  <rect x="400" y="95" width="50" height="28" rx="3" class="box"/>
  <text x="425" y="113" class="label">FASTQ</text>

  <!-- Damage model -->
  <rect x="490" y="60" width="70" height="36" rx="3" class="box-accent"/>
  <text x="525" y="75" class="label">Damage</text>
  <text x="525" y="88" class="label-small">model</text>

  <!-- Frame selection -->
  <rect x="490" y="115" width="70" height="36" rx="3" class="box-accent"/>
  <text x="525" y="130" class="label">Frame</text>
  <text x="525" y="143" class="label-small">selection</text>

  <!-- p_read -->
  <rect x="600" y="85" width="55" height="36" rx="3" class="box-accent"/>
  <text x="627" y="100" class="label">p_read</text>
  <text x="627" y="113" class="label-small">Bayesian</text>

  <!-- Output -->
  <rect x="695" y="75" width="65" height="50" rx="3" class="box"/>
  <text x="727" y="93" class="label">GFF3</text>
  <text x="727" y="106" class="label">FASTA</text>
  <text x="727" y="119" class="label-small">.agd</text>

  <!-- Pass 2 arrows -->
  <path d="M 450 105 L 470 78 L 488 78" class="arrow"/>
  <path d="M 450 115 L 470 133 L 488 133" class="arrow"/>
  <path d="M 562 78 L 580 78 L 580 100 L 598 100" class="arrow"/>
  <path d="M 562 133 L 580 133 L 580 108 L 598 108" class="arrow"/>
  <path d="M 657 103 L 693 103" class="arrow"/>

  <!-- Profile to Pass 2 arrow -->
  <path d="M 302 103 L 398 103" class="arrow-dashed"/>
  <text x="350" y="95" class="label-small">profile</text>
</svg>
