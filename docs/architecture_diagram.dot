digraph G {
  rankdir=LR;
  graph [bgcolor="white", pad="0.3", nodesep="0.4", ranksep="0.6"];
  node  [fontname="Helvetica", fontsize=11, color="#525252", fontcolor="#1a1a1a",
         shape=box, style="rounded", penwidth=0.8, margin="0.15,0.10"];
  edge  [color="#525252", penwidth=0.8, arrowsize=0.7, fontname="Helvetica", fontsize=9];

  subgraph cluster_pass1 {
    label="Pass 1: Sample Profiling";
    labelloc="t"; labeljust="l";
    fontname="Helvetica"; fontsize=12;
    color="#d97706"; penwidth=1.5; style="rounded";
    bgcolor="#fffbeb";

    FASTQ1 [label="FASTQ", fillcolor="white", style="rounded,filled"];
    A [label="Channel A\nT/(T+C)", fillcolor="#fef3c7", style="rounded,filled", color="#d97706"];
    B [label="Channel B\nstop conversion", fillcolor="#dcfce7", style="rounded,filled", color="#15803d"];
    P [label="d_max, Î»", fillcolor="#f5f5f5", style="rounded,filled"];

    FASTQ1 -> A;
    FASTQ1 -> B;
    A -> P;
    B -> P;
  }

  subgraph cluster_pass2 {
    label="Pass 2: Gene Prediction";
    labelloc="t"; labeljust="l";
    fontname="Helvetica"; fontsize=12;
    color="#15803d"; penwidth=1.5; style="rounded";
    bgcolor="#f0fdf4";

    FASTQ2 [label="FASTQ", fillcolor="white", style="rounded,filled"];
    DM [label="Damage\nmodel", fillcolor="#dbeafe", style="rounded,filled", color="#1d4ed8"];
    FS [label="Frame\nselection", fillcolor="#f3e8ff", style="rounded,filled", color="#7c3aed"];
    PR [label="p_read", fillcolor="#dbeafe", style="rounded,filled", color="#1d4ed8"];
    OUT [label="GFF3\nFASTA\n.agd", fillcolor="#f5f5f5", style="rounded,filled"];

    FASTQ2 -> DM;
    FASTQ2 -> FS;
    DM -> PR;
    FS -> PR;
    PR -> OUT;
  }

  P -> FASTQ2 [style="dashed", color="#d97706", label="profile", fontcolor="#d97706"];
}
